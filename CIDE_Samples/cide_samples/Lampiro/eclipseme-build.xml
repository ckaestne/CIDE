<?xml version="1.0" encoding="UTF-8"?>
<!--
	Automatically generated by EclipseME on Fri Aug 29 18:07:45 CEST 2008
	DO NOT ALTER THIS FILE.  IT WILL BE OVERWRITTEN

	Changes may be made to build.xml and user-build.properties
-->
<project default="-eclipseme-build" name="eclipseme-lampiro">
	<path id="classpath.lampiro">
		<path location="${path.build.classes}" />
		<path location="${path.build.classes}/_no_export" />
		<path location="${project.root.lampiro}/lib/xmlpull_1_1_3_1.jar" />
		<path location="${project.root.lampiro}/lib/bouncycastle.jar" />
	</path>
	<target name="-eclipseme-initialize">
		<echo message="Initializing EclipseME Antenna build environment..." />
		<taskdef resource="antenna.properties">
			<classpath location="${path.antenna.jar}" />
		</taskdef>
		<mkdir dir="${path.build.classes}/_no_export" />
	</target>
	<target name="-eclipseme-preprocess">
		<echo message="Preprocessing EclipseME Antenna build environment..." />
		<wtkpreprocess verbose="false" srcdir="${project.root.lampiro}/src" destdir="${project.root.lampiro}/preprocess/src" device="Generic/Java" symbols="${preprocess.symbols}" printsymbols="true">
			<excludesfile name="${exclude-list}" />
		</wtkpreprocess>
	</target>
	<target name="-eclipseme-manifest">
		<echo message="Building manifest file" />
		<manifest file="MANIFEST.MF">
			<attribute name="Built-By" value="${user.name}" />
			<attribute name="MIDlet-1" value="${manifest.midlet.name},${manifest.midlet.icon},${manifest.midlet.class}" />
			<attribute name="MIDlet-Name" value="${manifest.midlet.name}" />
			<attribute name="MIDlet-Vendor" value="${manifest.midlet.vendor}" />
			<attribute name="MIDlet-Version" value="${manifest.midlet.version}" />
			<attribute name="MIDlet-Icon" value="${manifest.midlet.icon}" />
			<attribute name="Manifest-Version" value="1.0" />
			<attribute name="Lampiro-BOSH-Host" value="bosh.bluendo.com" />
			<attribute name="Lampiro-BOSH-Path" value="/httpb" />
			<attribute name="Lampiro-BOSH-URL" value="socket://bosh.bluendo.com:10080" />
			<attribute name="FlipInsensitive" value="True" />
			<attribute name="Background" value="True" />
			<attribute name="MicroEdition-Configuration" value="CLDC-1.1" />
			<attribute name="MicroEdition-Profile" value="MIDP-2.0" />
		</manifest>
	</target>
	<target depends="-eclipseme-initialize,-eclipseme-preprocess,-eclipseme-manifest" name="-eclipseme-build">
		<echo message="Building jad files..." />

		<wtkjad jadfile="${midlet.name}.jad" jarfile="${path.build.output}/${midlet.name}.jar" name="${midlet.name}">
			<!-- Add user-defined attributes to the JAD -->
			<attribute name="MicroEdition-Profile" value="MIDP-2.0" />
			<attribute name="MicroEdition-Configuration" value="CLDC-1.1" />
			<attribute name="MIDlet-Version" value="${manifest.midlet.version}" />
			<attribute name="MIDlet-Icon" value="${${manifest.midlet.version.icon}" />
			<attribute name="Built-By" value="${user.name}" />
			<attribute name="MIDlet-1" value="${manifest.midlet.name},${manifest.midlet.icon},${manifest.midlet.class}" />
			<attribute name="MIDlet-Name" value="${manifest.midlet.name}" />
			<attribute name="MIDlet-Vendor" value="${manifest.midlet.vendor}" />
			<attribute name="MIDlet-Icon" value="${manifest.midlet.icon}" />
			<attribute name="Manifest-Version" value="1.0" />
			<attribute name="Lampiro-BOSH-Host" value="bosh.bluendo.com" />
			<attribute name="Lampiro-BOSH-Path" value="/httpb" />
			<attribute name="Lampiro-BOSH-URL" value="socket://bosh.bluendo.com:10080" />
			<attribute name="FlipInsensitive" value="True" />
			<attribute name="Background" value="True" />
			<attribute name="MicroEdition-Configuration" value="CLDC-1.1" />
			<attribute name="MicroEdition-Profile" value="MIDP-2.0" />
			<midlet name="${manifest.midlet.name}" icon="${manifest.midlet.icon}" class="${manifest.midlet.class}">
			</midlet>
		</wtkjad>

		<echo message="Building source files..." />
		<wtkbuild destdir="${path.build.classes}" encoding="${src.encoding}" source="1.3" sourcepath="" srcdir="${project.root.lampiro}/preprocess/src">
			<classpath refid="classpath.lampiro" />
			<excludesfile name="${exclude-list}" />
		</wtkbuild>
		<wtkbuild destdir="${path.build.classes}" encoding="${src.encoding}" source="1.3" sourcepath="" srcdir="${project.root.lampiro}/res">
			<classpath refid="classpath.lampiro" />
		</wtkbuild>
	</target>
	<target depends="-eclipseme-build" name="-eclipseme-jar">
		<echo message="Generating unobfuscated jar file..." />
		<antcall target="-eclipseme-clean" />
		<delete includeEmptyDirs="true" quiet="true">
			<fileset dir="${path.build.output}" includes="*,*/**" />
		</delete>
		<antcall target="-eclipseme-internal-package" />
	</target>
	<target depends="-eclipseme-build" name="-eclipseme-deployable">
		<echo message="Generating obfuscated jar file..." />
		<antcall target="-eclipseme-clean" />
		<delete includeEmptyDirs="true" quiet="true">
			<fileset dir="${path.build.output}" includes="*,*/**" />
		</delete>
		<antcall target="-eclipseme-internal-package">
			<param name="flag.should.obfuscate" value="true" />
		</antcall>
	</target>
	<target depends="-eclipseme-build" name="-eclipseme-internal-package">
		<copy file="${midlet.name}.jad" todir="${path.build.output}" />
		<wtkpackage autoversion="${flag.autoversion}" jadfile="${path.build.output}/${midlet.name}.jad" jarfile="${path.build.output}/${midlet.name}.jar" obfuscate="false" preverify="${flag.preverify}">
			<fileset dir="${path.build.classes}">
				<exclude name="_no_export/" />
			</fileset>
			<classpath refid="classpath.lampiro" />
			<fileset dir="${project.root.lampiro}/preprocess/src">
				<exclude name="**/*.java" />
				<exclude name="build/" />
			</fileset>
			<fileset dir="${project.root.lampiro}/res">
				<exclude name="**/*.java" />
				<exclude name="build/" />
				<excludesfile name="${exclude-list}" />
			</fileset>
			<zipfileset src="${project.root.lampiro}/lib/xmlpull_1_1_3_1.jar" />
			<zipfileset src="${project.root.lampiro}/lib/bouncycastle.jar" />
		</wtkpackage>
		<antcall target="-eclipseme-obfuscate" />
	</target>
	<target if="flag.should.obfuscate" name="-eclipseme-obfuscate">
		<wtkobfuscate jadfile="${path.build.output}/${midlet.name}.jad" jarfile="${path.build.output}/${midlet.name}.jar">
			<argument value="'-keep public class lampiro.LampiroMidlet'" />
			<argument value="-dontusemixedcaseclassnames -dontnote -defaultpackage '' -optimizationpasses ${optimizationpasses} -printseeds ${path.build.output}/seeds.txt -printmapping ${path.build.output}/mappings.txt -microedition" />
		</wtkobfuscate>
		<wtkpreverify if="flag.preverify" jadfile="${path.build.output}/${midlet.name}.jad" jarfile="${path.build.output}/${midlet.name}.jar" />
	</target>
	<target depends="-eclipseme-deployable" name="-eclipseme-run">
		<echo message="Running emulator..." />
		<wtkrun device="${run.device.name}" jadfile="${path.build.output}/${midlet.name}.jad" trace="${run.trace.options}" wait="true" />
	</target>
	<target depends="-eclipseme-deployable" name="-eclipseme-makeprc">
		<echo message="Generating Palm PRC file..." />
		<wtkmakeprc jadfile="${path.build.output}/${midlet.name}.jad" prcfile="${path.build.output}/${midlet.name}.prc" />
	</target>
	<target name="-eclipseme-clean">
		<delete includeEmptyDirs="true" quiet="true">
			<fileset dir="${project.root.lampiro}/preprocess}" includes="*,*/**" />
			<fileset dir="${path.build.classes}" includes="*,*/**" />
		</delete>
	</target>
</project>